:root {
    --bg-color: #f0f4f8;
    --text-color: #2d3748;
    --primary-color: #4a5568;
    --accent-color: #3182ce;
    --accent-hover: #2b6cb0;
    --error-color: #e53e3e;
    --success-color: #38a169;
    --card-bg: #ffffff;
    --font-family: 'Heebo', sans-serif;
    --input-size: 40px;
    --gap-size: 8px;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: var(--font-family);
    background-color: var(--bg-color);
    color: var(--text-color);
    height: 100vh;
    display: flex;
    justify-content: center;
    overflow: hidden;
    /* Prevent scroll on mobile if possible */
}

.app-container {
    width: 100%;
    max-width: 600px;
    height: 100%;
    display: flex;
    flex-direction: column;
    padding: 10px 20px;
    /* Reduced padding top/bottom */
    position: relative;
    overflow-y: auto;
    /* Allow scroll if needed on really small screens */
}

/* UTILS */
.hidden {
    display: none !important;
}

/* SCREENS */
.screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, #e0e7ff 0%, #f0f4f8 100%);
    z-index: 50;
    padding: 20px;
    text-align: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.screen.active {
    opacity: 1;
    pointer-events: all;
}

.content-wrapper {
    max-width: 400px;
}

.main-title {
    font-size: 3.5rem;
    font-weight: 900;
    color: var(--text-color);
    margin-bottom: 2rem;
    line-height: 1.1;
    background: -webkit-linear-gradient(45deg, var(--accent-color), #805ad5);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.instructions {
    font-size: 1.2rem;
    color: #4a5568;
    margin-bottom: 3rem;
    line-height: 1.6;
}

.instructions p {
    margin-bottom: 1rem;
}

.instructions .note {
    font-weight: 700;
    color: var(--error-color);
    font-size: 1rem;
}

/* BUTTONS */
.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 50px;
    font-family: var(--font-family);
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.2s;
}

.btn:active {
    transform: scale(0.95);
}

.btn.primary {
    background-color: var(--accent-color);
    color: white;
    box-shadow: 0 4px 15px rgba(49, 130, 206, 0.4);
}

.btn.primary:hover {
    background-color: var(--accent-hover);
}

.btn.secondary {
    background-color: #edf2f7;
    color: #4a5568;
}

.big-btn {
    font-size: 1.3rem;
    padding: 15px 40px;
    width: 100%;
    white-space: pre-line;
    /* Handle line breaks in button text */
    line-height: 1.3;
}

/* HEADER */
/* Sticky header to ensure visibility with keyboard */
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    font-weight: 700;
    font-size: 1.2rem;
    background: var(--bg-color);
    /* Match bg to hide content behind */
    position: sticky;
    top: 0;
    z-index: 10;
}

.score-board .label {
    font-weight: 300;
    color: #718096;
    margin-left: 5px;
}

#timer-display {
    font-size: 1.8rem;
    /* Made slightly bigger for visibility */
    color: var(--accent-color);
    font-variant-numeric: tabular-nums;
}

/* MAIN GAME AREA */
main {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Center vertically */
    align-items: center;
    gap: 20px;
    padding-bottom: 60px;
    /* Adjust padding to not hide behind keyboard if possible */
}

/* Adjust centering when keyboard is active is tricky without JS,
   but flex 'justify-content: center' usually handles viewport resize well on Android/iOS
   (viewport height shrinks). 
   We ensure the content is compact.
*/

.word-card {
    text-align: center;
}

#foreign-word {
    font-size: 2.5rem;
    font-weight: 900;
    color: var(--text-color);
    margin-bottom: 10px;
}

/* INPUTS */
.input-area {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 6px;
    direction: rtl;
}

.word-group {
    display: flex;
    gap: 4px;
    margin: 0 6px 10px 6px;
    /* Added bottom margin for multi-line flow */
}

.letter-input {
    width: var(--input-size);
    height: 50px;
    border: 2px solid #cbd5e0;
    border-radius: 8px;
    font-size: 1.5rem;
    text-align: center;
    background: var(--card-bg);
    font-family: var(--font-family);
    font-weight: 700;
    color: var(--text-color);
    transition: all 0.2s ease;
    caret-color: var(--accent-color);
}

.letter-input:focus {
    border-color: var(--accent-color);
    outline: none;
    box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.2);
    transform: translateY(-2px);
}

.letter-input.correct {
    background-color: #c6f6d5;
    border-color: var(--success-color);
    color: #22543d;
}

.letter-input.shake {
    animation: shake 0.4s cubic-bezier(.36, .07, .19, .97) both;
    border-color: var(--error-color);
}

/* CONTROLS */
.controls {
    margin-top: 10px;
    width: 100%;
    display: flex;
    justify-content: center;
}

#skip-btn {
    width: 100%;
    max-width: 300px;
}

/* MODAL */
.modal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(5px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 100;
    opacity: 1;
    transition: opacity 0.3s ease;
}

.modal.hidden {
    opacity: 0;
    pointer-events: none;
}

.modal-content {
    text-align: center;
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    min-width: 300px;
}

.big-number {
    font-size: 4rem;
    font-weight: 900;
    color: var(--accent-color);
}

/* ANIMATIONS */
@keyframes shake {

    10%,
    90% {
        transform: translate3d(-1px, 0, 0);
    }

    20%,
    80% {
        transform: translate3d(2px, 0, 0);
    }

    30%,
    50%,
    70% {
        transform: translate3d(-4px, 0, 0);
    }

    40%,
    60% {
        transform: translate3d(4px, 0, 0);
    }
}

@keyframes popIn {
    0% {
        transform: scale(0.8);
        opacity: 0;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.fade-in {
    animation: popIn 0.3s ease-out;
}

/* RESPONSIVE & COMPACT MODE */
@media (max-width: 600px) {
    .app-container {
        padding: 5px 15px;
        /* Minimal padding */
    }

    /* HEADER: Compact inline style */
    header {
        padding: 2px 0;
        /* Minimal padding */
        font-size: 0.9rem;
        /* Smaller text */
        border-bottom: none;
        /* Remove border to reduce visual separation */
        background: transparent;
        /* Merge with background */
        position: relative;
        /* Let it flow normally or keep sticky? User wants it "right above". Sticky is safer for scroll but if it fits we don't need scroll. Let's keep sticky but zero gap. */
        top: 0;
        z-index: 10;
        margin-bottom: 0;
    }

    #timer-display {
        font-size: 1.2rem;
    }

    /* MAIN: Remove spacer padding */
    main {
        padding-top: 5px;
        /* Almost touching header */
        gap: 5px;
        /* Minimal gap */
        justify-content: flex-start;
        padding-bottom: 5px;
    }

    .word-card {
        margin-bottom: 0;
        /* No margin */
    }

    #foreign-word {
        font-size: 1.6rem;
        margin-bottom: 2px;
        margin-top: 0;
    }

    .input-area {
        gap: 4px;
        margin-top: 0;
    }

    .word-group {
        margin: 0 4px 8px 4px;
    }

    :root {
        --input-size: 32px;
        /* Smaller inputs */
    }

    .letter-input {
        height: 40px;
        font-size: 1.2rem;
    }

    .controls {
        margin-top: 10px;
    }

    /* Ensure start screen title fits */
    .main-title {
        font-size: 2.2rem;
    }

    .instructions {
        font-size: 1rem;
        margin-bottom: 1.5rem;
    }
}

/* Extra small screens (small phones with keyboard open) */
@media (max-width: 600px) and (max-height: 500px) {
    main {
        gap: 10px;
        padding-top: 10px;
    }

    #foreign-word {
        font-size: 1.5rem;
    }

    .controls {
        margin-top: 5px;
    }

    .btn {
        padding: 8px 16px;
        font-size: 0.9rem;
    }
}

/* LEADERBOARD & FORM STYLES */
.leaderboard-section {
    margin: 20px 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.5);
    padding: 15px;
    border-radius: 12px;
}

.leaderboard-section h3 {
    margin-bottom: 10px;
    color: var(--primary-color);
}

#leaderboard-container {
    max-height: 150px;
    overflow-y: auto;
    font-size: 0.9rem;
}

.leaderboard-table {
    width: 100%;
    border-collapse: collapse;
}

.leaderboard-table th,
.leaderboard-table td {
    padding: 5px;
    text-align: right;
    border-bottom: 1px solid #e2e8f0;
}

.leaderboard-table th {
    color: #a0aec0;
    font-size: 0.8rem;
}

.rank-cell {
    font-weight: 700;
    color: var(--accent-color);
    width: 30px;
}

.score-cell {
    font-weight: 700;
    text-align: left !important;
}

/* HIGH SCORE FORM */
#high-score-form {
    margin: 20px 0;
    animation: popIn 0.5s ease;
}

.congrats-text {
    color: var(--success-color);
    font-weight: 700;
    margin-bottom: 10px;
}

.input-group {
    display: flex;
    gap: 10px;
    justify-content: center;
}

#player-name-input {
    padding: 10px;
    border: 2px solid #cbd5e0;
    border-radius: 8px;
    font-family: var(--font-family);
    font-size: 1rem;
    width: 100%;
    max-width: 200px;
    direction: rtl;
}

#player-name-input:focus {
    border-color: var(--accent-color);
    outline: none;
}

.small-btn {
    padding: 10px 20px;
    white-space: nowrap;
}

/* LOADER */
.loader {
    color: #718096;
    font-style: italic;
    font-size: 0.9rem;
}

/* Fix mobile scroll for leaderboard */
@media (max-height: 500px) {
    .leaderboard-section {
        max-height: 100px;
        overflow-y: scroll;
    }
}